created: 20171216013246862
creator: h0p3
modified: 20180831184542345
modifier: h0p3
revision: 0
title: wiki-snapshot.sh
type: text/vnd.tiddlywiki

```bash
#!/bin/bash

# Nightly Snapshot Git Commit+Push

# Fuck you, crontab!
#PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:~/bin:~/scripts

# logfile timestamp
date +"%Y.%m.%d-%T" #Getting the date/time

# Git
TIME=`date +20%y.%m.%d` #The date, for the name of the folder
H0P3=$TIME-h0p3.wiki-index.html #Name of said folder
J3D1H=$TIME-j3d1h.wiki-index.html
LUXB0X=$TIME-1uxb0x.wiki-index.html
K0SH3K=$TIME-k0sh3k.wiki-index.html

#cd /home/h0p3/Downloads/Wiki #cd into the folder, so the path won't show
#git add index.html #Add the html file
#git add index.html.sum #Add the checksum
#git add index.html.sig #Add the signature

#git commit -m "$H0P3" #Creating a commit

#git push -f https://m6ram:foobar@github.com/m6ram/h0p3s-wiki #Push to GitHub

###

cd /home/h0p3/syncs/j3d1h

git config --global user.email "foobar"
git config --global user.name "j3d1h"

git add index.html

git commit -m "$J3D1H"

git push https://j3d1h:foobar@github.com/j3d1h/j3d1hs-wiki

###

cd /home/h0p3/syncs/1uxb0x

git config --global user.email "foobar"
git config --global user.name "1uxb0x"

git add index.html

git commit -m "$LUXB0X"

git push https://1uxb0x:foobar@github.com/1uxb0x/1uxb0xs-wiki

###

cd /home/h0p3/syncs/bookwyrm

git config --global user.email "foobar"
git config --global user.name "k0sh3k"

git add index.html

git commit -m "$K0SH3K"

git push https://k0sh3k:foobar@github.com/k0sh3k/k0sh3ks-wiki


### Daily Backup Snapshot of index.html
# Vars
git config --global user.email "foobar"
git config --global user.name "m6ram"
FILENAME1=$TIME-h0p3.wiki-index.html
FILENAME2=$FILENAME1.sig
SRCDIR=/home/h0p3/Downloads/Wiki
DESDIR=/home/h0p3/syncs/wiki-snapshots

# Copy and compress
cp -f $SRCDIR/index.html $DESDIR
cp -f $SRCDIR/index.html.sig $DESDIR
cd $DESDIR
git add index.html
git add index.html.sig
git commit -m "$H0P3"
git push --set-upstream https://m6ram:foobar@github.com/m6ram/h0p3s-wiki.git master
git push --set-upstream https://m6ram:foobar@gitlab.com/m6ram/h0p3s-wiki.git master
git push --set-upstream https://m6ram:foobar@bitbucket.org/m6ram/h0p3s-wiki.git master
mv index.html $FILENAME1
mv index.html.sig $FILENAME2
tar -cf $FILENAME1.tar $FILENAME1 $FILENAME2
zstd -f -19 -T7 $FILENAME1.tar
rm $FILENAME1 $FILENAME2 $FILENAME1.tar

# Dropbox Snapshots Backup
dropbox_uploader.sh upload /home/h0p3/syncs/wiki-snapshots/* h0p3_wikisnapshots/


### IPFS Update
#sleep 2s
#ipfs name publish $(ipfs add -r -Q ~/Syncs/Wiki/Daily-Snapshots)
```